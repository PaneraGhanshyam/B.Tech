CREATE TABLE PERSON (
    WORKERID INT PRIMARY KEY IDENTITY(1,1),
    FIRSTNAME VARCHAR(100) NOT NULL,
    LASTNAME VARCHAR(100) NOT NULL,
    SALARY DECIMAL(8, 2) NOT NULL,
    JOININGDATE DATETIME NOT NULL,
    DepartmentID INT REFERENCES DEPARTMENT(DepartmentID),
    DesignationID INT REFERENCES DESIGNATION(DesignationID)
);

CREATE TABLE DEPARTMENT (
    DepartmentID INT PRIMARY KEY,
    DepartmentName VARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE DESIGNATION (
    DesignationID INT PRIMARY KEY,
    DesignationName VARCHAR(100) NOT NULL UNIQUE
);

INSERT INTO DEPARTMENT (DepartmentID, DepartmentName) VALUES
(1, 'Admin'),
(2, 'IT'),
(3, 'HR'),
(4, 'Account');

INSERT INTO DESIGNATION (DesignationID, DesignationName) VALUES
(11, 'Jobber'),
(12, 'Welder'),
(13, 'Clerk'),
(14, 'Manager'),
(15, 'CEO');

INSERT INTO PERSON (FIRSTNAME, LASTNAME, SALARY, JOININGDATE, DepartmentID, DesignationID) VALUES
('Rahul', 'Anshu', 56000, '1990-01-01', 1, 12),
('Hardik', 'Hinsu', 18000, '1990-09-25', 2, 11),
('Bhavin', 'Kamani', 25000, '1991-05-14', NULL, 11),
('Bhoomi', 'Patel', 39000, '2014-02-20', 1, 13),
('Rohit', 'Rajgor', 17000, '1990-07-23', 2, 15),
('Priya', 'Mehta', 25000, '1990-10-18', 2, NULL),
('Neha', 'Trivedi', 18000, '2014-02-20', 3, 15);

SELECT * FROM [dbo].[DEPARTMENT]
SELECT * FROM [dbo].[DESIGNATION]
SELECT * FROM [dbo].[PERSON]


--1. Create a Procedure on Department, Designation & Person Table 
--for INSERT, UPDATE & DELETE Procedures.
EXEC PR_DEPARTMENT_INSERT 5,'CSE'
CREATE PROCEDURE PR_DEPARTMENT_INSERT
	@DEPARTMENTID INT,
	@DEPARTMENTNAME VARCHAR(100)
AS
BEGIN
	INSERT INTO DEPARTMENT VALUES(@DEPARTMENTID,@DEPARTMENTNAME);
END

EXEC PR_DEPARTMENT_UPDATE 5,'CE'
CREATE PROCEDURE PR_DEPARTMENT_UPDATE
	@DEPARTMENTID INT,
	@DEPARTMENTNAME VARCHAR(100)
AS
BEGIN
	UPDATE DEPARTMENT SET DepartmentName=@DEPARTMENTNAME WHERE DepartmentID=@DEPARTMENTID;
END

EXEC PR_DEPARTMENT_DELETE 5
CREATE PROCEDURE PR_DEPARTMENT_DELETE
	@DEPARTMENTID INT
AS
BEGIN 
	DELETE FROM DEPARTMENT WHERE DepartmentID=@DEPARTMENTID;
END

EXEC PR_DESIGNATION_INSERT 16,'TEACHER'
CREATE PROCEDURE PR_DESIGNATION_INSERT
	@DESIGNATIONID INT,
	@DESIGNATIONNAME VARCHAR(100)
AS
BEGIN
	INSERT INTO DESIGNATION VALUES(@DESIGNATIONID,@DESIGNATIONNAME);
END

EXEC PR_DESIGNATION_UPDATE 16,'PROFESSOR'
CREATE PROCEDURE PR_DESIGNATION_UPDATE
	@DESIGNATIONID INT,
	@DESIGNATIONNAME VARCHAR(100)
AS
BEGIN
	UPDATE DESIGNATION SET DesignationName=@DESIGNATIONNAME WHERE DesignationID=@DESIGNATIONID;
END

EXEC PR_DESIGNATION_DELETE 16
CREATE PROCEDURE PR_DESIGNATION_DELETE
	@DESIGNATIONID INT
AS
BEGIN 
	DELETE FROM DESIGNATION WHERE DesignationID=@DESIGNATIONID
END

EXEC PR_PERSON_INSERT 'GHANSHYAM','PANERA',100000.00,'2024-9-20',1,15
CREATE PROCEDURE PR_PERSON_INSERT
	@FISRTNAME VARCHAR(100),
	@LASTNAME VARCHAR(100),
	@SALARY DECIMAL(8,2),
	@JOININGDATE DATE,
	@DEPARTMENTID INT,
	@DESIGNATIONID INT
AS
BEGIN
	INSERT INTO PERSON VALUES(@FISRTNAME,@LASTNAME,@SALARY,@JOININGDATE,@DEPARTMENTID,@DESIGNATIONID);
END

EXEC PR_PERSON_UPDATE 9,'GHANSHYAM','PANERA',150000.00,'2024-9-20',1,15
CREATE PROCEDURE PR_PERSON_UPDATE
	@WORKERID INT,
	@FIRSTNAME VARCHAR(100),
	@LASTNAME VARCHAR(100),
	@SALARY DECIMAL(8,2),
	@JOININGDATE DATETIME,
	@DEPARTMENTID INT,
	@DESIGNATIONID INT
AS
BEGIN
	UPDATE PERSON SET FIRSTNAME=@FIRSTNAME,LASTNAME=@LASTNAME,
	SALARY=@SALARY,JOININGDATE=@JOININGDATE,DEPARTMENTID=@DEPARTMENTID,
	DESIGNATIONID=@DESIGNATIONID WHERE WORKERID=@WORKERID;
END

EXEC PR_PERSON_DELETE 9
CREATE PROCEDURE PR_PERSON_DELETE
	@WORKERID INT
AS
BEGIN
	DELETE FROM PERSON WHERE WORKERID=@WORKERID;
END

--2. Create a Procedure on Department, Designation & Person Table 
--for SELECTBYPRIMARYKEY
EXEC PR_DEPARTMENT_SELECT 2
CREATE PROCEDURE PR_DEPARTMENT_SELECT
	@DEPARTMENTID INT
AS
BEGIN
	SELECT * FROM DEPARTMENT WHERE DepartmentID=@DEPARTMENTID;
END

EXEC PR_DESIGNATION_SELECT 15
CREATE PROCEDURE PR_DESIGNATION_SELECT
	@DESIGNATIONID INT
AS
BEGIN
	SELECT * FROM DESIGNATION WHERE DesignationID=@DESIGNATIONID;
END

EXEC PR_PERSON_SELECT 8
CREATE PROCEDURE PR_PERSON_SELECT
	@WORKERID INT
AS
BEGIN
	SELECT * FROM PERSON WHERE WORKERID=@WORKERID;
END

--3. Create a Procedure on Department, Designation & Person Table 
--(If foreign key is available then do write join and take columns on select list)
EXEC GetPersonDetails 8
CREATE PROCEDURE GetPersonDetails
    @WORKERID INT
AS
BEGIN
    SELECT 
        P.WORKERID,
        P.FIRSTNAME,
        P.LASTNAME,
        P.SALARY,
        P.JOININGDATE,
        D.DepartmentName,
        DS.DesignationName
    FROM 
        PERSON P
    LEFT JOIN 
        DEPARTMENT D ON P.DepartmentID = D.DepartmentID
    LEFT JOIN 
        DESIGNATION DS ON P.DesignationID = DS.DesignationID
    WHERE 
        P.WORKERID = @WORKERID;
END;

--4. Create a Procedure that shows details of the first 3 persons.
EXEC PR_PERSON_SELECTTOPTHREE 
ALTER PROCEDURE PR_PERSON_SELECTTOPTHREE
AS
BEGIN
	SELECT TOP 3 * FROM 
	PERSON P LEFT JOIN DEPARTMENT DEP ON P.DEPARTMENTID=DEP.DepartmentID
	LEFT JOIN  DESIGNATION DES ON DES.DesignationID=P.DesignationID
END






